<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq"
        crossorigin="anonymous"></script>
</head>

<title>Gestione Prodotti</title>
</head>

<body>
    <div style="background-color: var(--bs-primary-border-subtle); color: white; height: 100%; ">
        <h1>Gestione Prodotti</h1>

        <!-- Form Aggiunta -->
        <form id="formDiAggiunta" onsubmit="aggiungiProdotto(); return false;">
            <input type="text" id="nome" placeholder="Nome" required>
            <input type="text" id="prodotto" placeholder="Prodotto" required>
            <input type="number" id="prezzo" placeholder="Prezzo" required>
            <input type="number" id="quantita" placeholder="Quantità" required>
            <button type="submit" class="btn btn-primary">Aggiungi Prodotto</button>
        </form>

        <!-- Combobox Selezione -->
        <select id="prodottoSelezionato">
            <option value="">-- Seleziona Prodotto --</option>
        </select>
        <button class="btn btn-primary" onclick="mostraProdottiSelezionati()">Visualizza Prodotto</button>

        <!-- Bottone Mostra Tutti -->
        <button class="btn btn-primary" onclick="mostraTuttiProdotti()">Visualizza Tutti i Prodotti</button>
        <button class="btn btn-danger" onclick="rimuoviProdotto()">Rimuovi Prodotto</button>

        <!-- Form Ricerca -->
        <form id="formDiRicerca" onsubmit="cercaProdotto(event)">
            <input type="text" id="cerca" placeholder="Cerca prodotto">
            <button class="btn btn-success" type="submit">Cerca</button>
        </form>
        <center>
            <!-- Tabella -->
            <table id="prodottiTabella" border="2" style="height: 200px; width: 500px;">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Prodotto</th>
                        <th>Prezzo</th>
                        <th>Quantità</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </center>
    </div>

    <script>
        let prodotti = [
            { nome: "Mario Rossi", prodotto: "Laptop", prezzo: 1200, quantita: 3 },
            { nome: "Giulia Bianchi", prodotto: "Mouse", prezzo: 25, quantita: 10 },
            { nome: "Luca Verdi", prodotto: "Monitor", prezzo: 250, quantita: 5 }
        ];

        window.onload = () => {
            aggiornaSelect();
            mostraTuttiProdotti();
        };

        function aggiungiProdotto() {
            const nome = document.getElementById('nome').value;
            const prodotto = document.getElementById('prodotto').value;
            const prezzo = (document.getElementById('prezzo').value);
            const quantita = (document.getElementById('quantita').value);

            prodotti.push({ nome, prodotto, prezzo, quantita });

            aggiornaSelect();
            mostraTuttiProdotti();
            document.getElementById("formDiAggiunta").reset();
        }

        function aggiornaSelect() {
            const select = document.getElementById('prodottoSelezionato');
            select.innerHTML = '<option value="">-- Seleziona Prodotto --</option>';
            const prodottiUnici = new Set();

            prodotti.forEach(p => {
                if (!prodottiUnici.has(p.prodotto)) {
                    prodottiUnici.add(p.prodotto);
                    const option = document.createElement('option');
                    option.value = p.prodotto;
                    option.textContent = p.prodotto;
                    select.appendChild(option);
                }
            });
        }

        function mostraTabella(lista) {
            const tbody = document.querySelector('#prodottiTabella tbody');
            tbody.innerHTML = "";

            lista.forEach(p => {
                const row = document.createElement('tr');
                row.innerHTML = `
          <td>${p.nome}</td>
          <td>${p.prodotto}</td>
          <td>${p.prezzo} €</td>
          <td>${p.quantita}</td>
        `;
                tbody.appendChild(row);
            });
        }

        function mostraTuttiProdotti() {
            mostraTabella(prodotti);
        }

        function mostraProdottiSelezionati() {
            const prodottoSelezionato = document.getElementById('prodottoSelezionato').value;
            if (prodottoSelezionato === "") {
                alert("Seleziona un prodotto.");
                return;
            }
            const selezionati = prodotti.filter(p => p.prodotto === prodottoSelezionato);
            mostraTabella(selezionati);
        }

        function rimuoviProdotto() {
            const prodottoSelezionato = document.getElementById('prodottoSelezionato').value;
            if (prodottoSelezionato === "") {
                alert("Seleziona un prodotto da rimuovere.");
                return;
            }
            prodotti = prodotti.filter(p => p.prodotto !== prodottoSelezionato);
            aggiornaSelect();
            mostraTuttiProdotti();
        }

        function cercaProdotto(event) {
            event.preventDefault();
            const valoreRicerca = document.getElementById('cerca').value.toLowerCase();
            const risultati = prodotti.filter(p => p.prodotto.toLowerCase().includes(valoreRicerca));
            mostraTabella(risultati);
            document.getElementById("formDiRicerca").reset();
        }
    </script>
</body>

</html>